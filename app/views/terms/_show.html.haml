= html_safe(ap "native #{native}")
= html_safe(ap "learned #{learned}")
= html_safe(ap "audio #{audio}")
= html_safe(ap "typed #{typed}")
- answer = nil
- card_answer = ""
- @learned_translations.each do |learned_translation|
  - card_answer = "#{card_answer}, #{learned_translation.form}" unless card_answer.empty?
  - card_answer = learned_translation.form if card_answer.empty?
  - answer = learned_translation.clone
  - answer.form = ""

= hidden_field_tag "term_typed_answer", "#{card_answer}"

%p{:class => "giant mandarin"}
  - if native == "front" or native == "both"
    - @native_translations.each do |native_translation|
      %span.native_form= native_translation.form
  - if learned == "front" or learned == "both"
    - @learned_translations.each do |learned_translation|
      %span.learned_form= learned_translation.form
      .pad_from_top
      - unless learned_translation.pronunciation.nil?
        - words = {}
        %div{:class => "centre inline-block"}
          - learned_translation.pronunciation.split(' ').each do |word|
            %div{:class => "left", :style => "padding: 0.6em;"}
              %p{:class => "minor_title"}= word
              %p= (get_pronunciation_expansion word).html_safe
          .pad
//- if @card.audio.file?
//  =render :partial => '/audio_controls', :locals => {:audio_url => @card.audio.url}
//
- if typed == true
  .pad_from_top
  .section_break
  .pad_from_top
  - semantic_form_for(answer, :url => '#', :method => :post) do |f|
    = f.input :form, :as => :string, :label => false, :hint => I18n.t('deck.learn.labels.answer'), :required => false, :wrapper_html => {:class => 'width80 centre mandarin'}
  %p{:class => "centre contrast hidden", :id => "answer_result"} is correct
  :javascript
    //override the enter button on the formsubmit so that clicking enter performs a reveal rather than submitting the form
    $("#edit_translation_#{answer.id}").submit(function(event) {
      event.preventDefault();

      //only perform the enter action once
      if ($("#translation_form").attr('disabled') == true)
      {
        return false ;
      }

      $('#do_reveal').click();

      $("#translation_form").attr('disabled', true);
    });


#back_of_card{:class => "hidden"}
  .section_break
  %p{:class => "giant mandarin"}
    - if native == "back" or native == "both"
      - @native_translations.each do |native_translation|
        %span.native_form= native_translation.form
    - if learned == "back" or learned == "both"
      - @learned_translations.each do |learned_translation|
        %span.learned_form= learned_translation.form
        .pad_from_top
        - unless learned_translation.pronunciation.nil?
          - words = {}
          %div{:class => "centre inline-block"}
            - learned_translation.pronunciation.split(' ').each do |word|
              %div{:class => "left", :style => "padding: 0.6em;"}
                %p{:class => "minor_title"}= word
                %p= (get_pronunciation_expansion word).html_safe
            .pad